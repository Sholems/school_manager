{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///D:/school_manager/lib/utils.ts"],"sourcesContent":["\nimport { ScoreRow, Settings, Class, Subject, Student, Teacher, Staff, FeeStructure, Payment, Score, Attendance } from './types';\n\nexport const calculateGrade = (total: number) => {\n  if (total >= 75) return { grade: 'A', comment: 'Excellent' };\n  if (total >= 65) return { grade: 'B', comment: 'Very Good' };\n  if (total >= 50) return { grade: 'C', comment: 'Good' };\n  if (total >= 40) return { grade: 'D', comment: 'Fair' };\n  return { grade: 'F', comment: 'Fail' };\n};\n\nexport const generateId = () => crypto.randomUUID();\n\nexport const getCurrentTimestamp = () => Date.now();\n\nexport const getTodayString = () => new Date().toISOString().split('T')[0];\n\n// --- STORAGE KEYS ---\nexport const STORAGE_KEYS = {\n  SETTINGS: 'ng_school_settings',\n  STUDENTS: 'ng_school_students',\n  TEACHERS: 'ng_school_teachers',\n  STAFF: 'ng_school_staff',\n  CLASSES: 'ng_school_classes',\n  FEES: 'ng_school_fees',\n  PAYMENTS: 'ng_school_payments',\n  EXPENSES: 'ng_school_expenses',\n  SCORES: 'ng_school_scores',\n  ATTENDANCE: 'ng_school_attendance'\n};\n\n// Generic Load/Save\nexport const loadFromStorage = <T>(key: string, fallback: T): T => {\n  try {\n    const item = localStorage.getItem(key);\n    if (!item) return fallback;\n    const parsed = JSON.parse(item);\n\n    // For objects (like Settings), merge with fallback to ensure new keys exist\n    if (typeof fallback === 'object' && fallback !== null && !Array.isArray(fallback)) {\n      return { ...fallback, ...parsed };\n    }\n\n    return parsed;\n  } catch (e) {\n    console.error(`Error loading ${key}`, e);\n    return fallback;\n  }\n};\n\nexport const saveToStorage = (key: string, data: any) => {\n  try {\n    localStorage.setItem(key, JSON.stringify(data));\n  } catch (e) {\n    console.error(`Error saving ${key}`, e);\n  }\n};\n\nexport const INITIAL_SETTINGS: Settings = {\n  id: 'singleton',\n  created_at: Date.now(),\n  updated_at: Date.now(),\n  school_name: 'Bright Future Academy',\n  school_address: '123 Education Lane, Lagos, Nigeria',\n  school_email: 'info@brightfuture.ng',\n  school_phone: '08012345678',\n  school_tagline: 'Knowledge for a brighter tomorrow',\n  current_session: '2025/2026',\n  current_term: 'First Term',\n\n  logo_media: null,\n  watermark_media: null,\n\n  director_name: 'Godspower Arthur',\n  director_signature: null,\n  head_of_school_name: 'Oluwaseun Arthur',\n  head_of_school_signature: null,\n\n  subjects_global: ['Mathematics', 'English', 'Science'],\n  terms: ['First Term', 'Second Term', 'Third Term'],\n  show_position: true,\n  show_skills: true,\n  tiled_watermark: false,\n  next_term_begins: '2025-05-04',\n  class_teacher_label: 'Class Teacher',\n  head_teacher_label: 'Head of School',\n  report_font_family: 'inherit',\n  report_scale: 100,\n  landing_hero_title: 'Excellence in Education',\n  landing_hero_subtitle: 'Nurturing the leaders of tomorrow with a world-class educational experience.',\n  landing_features: 'Academic Excellence, Modern Facilities, Expert Teachers, Safe Environment, Holistic Development, Affordable Fees',\n  landing_hero_image: null,\n  landing_about_text: 'We are committed to providing quality education that prepares students for the challenges of tomorrow. Our experienced teachers, modern facilities, and comprehensive curriculum ensure every child reaches their full potential.',\n  landing_gallery_images: [],\n  landing_primary_color: '#16a34a',\n  landing_show_stats: true,\n  landing_cta_text: 'Start Your Journey',\n  promotion_threshold: 50,\n  promotion_rules: 'manual',\n  role_permissions: {\n    super_admin: {\n      navigation: ['dashboard', 'students', 'teachers', 'staff', 'classes', 'grading', 'attendance', 'bursary', 'announcements', 'calendar', 'analytics', 'id_cards', 'broadsheet', 'data', 'settings'],\n      dashboardWidgets: ['stats', 'finance_chart', 'student_population', 'quick_actions', 'recent_transactions']\n    },\n    admin: {\n      navigation: ['dashboard', 'students', 'teachers', 'staff', 'classes', 'grading', 'attendance', 'bursary', 'announcements', 'calendar', 'analytics', 'id_cards', 'broadsheet', 'data', 'settings'],\n      dashboardWidgets: ['stats', 'finance_chart', 'student_population', 'quick_actions', 'recent_transactions']\n    },\n    teacher: {\n      navigation: ['dashboard', 'grading', 'attendance', 'announcements', 'calendar'],\n      dashboardWidgets: ['stats', 'quick_actions', 'my_classes']\n    },\n    student: {\n      navigation: ['dashboard', 'bursary', 'calendar', 'id_cards'],\n      dashboardWidgets: ['my_scores', 'my_attendance', 'my_fees']\n    },\n    parent: {\n      navigation: ['dashboard', 'bursary', 'calendar', 'id_cards'],\n      dashboardWidgets: ['my_scores', 'my_attendance', 'my_fees']\n    },\n    staff: {\n      navigation: ['dashboard', 'calendar'],\n      dashboardWidgets: ['quick_actions', 'my_tasks']\n    }\n  }\n};\n\nexport const PRESET_PRESCHOOL_SUBJECTS = [\n  'Language',\n  'Numeracy',\n  'Sensorial',\n  'Practical Life',\n  'Cultural Studies',\n  'Art',\n  'Story Telling',\n  'C.R.S'\n];\n\nexport const PRESET_PRIMARY_SUBJECTS = [\n  'Mathematics',\n  'English Language',\n  'Basic Science',\n  'Social Studies',\n  'Civic Education',\n  'C.R.S',\n  'Verbal Reasoning',\n  'Quantitative Reasoning',\n  'ICT',\n  'Creative Art',\n  'Vocational Aptitude',\n  'Writing'\n];\n\nexport const getSubjectsForClass = (cls: Class | undefined) => {\n  if (!cls) return [];\n  if (cls.subjects && cls.subjects.length > 0) return cls.subjects;\n\n  const lowerName = cls.name.toLowerCase();\n  if (lowerName.includes('play') || lowerName.includes('reception') || lowerName.includes('nursery') || lowerName.includes('kinder')) {\n    return PRESET_PRESCHOOL_SUBJECTS;\n  }\n  return PRESET_PRIMARY_SUBJECTS;\n};\n\nexport const PRESET_CLASSES = [\n  'Playschool', 'Reception', 'Kindergarten',\n  'Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5', 'Year 6'\n];\n\nexport const DOMAINS_AFFECTIVE = [\n  'Punctuality', 'Attentiveness', 'Neatness', 'Honesty', 'Self Control', 'Politeness', 'Leadership'\n];\n\nexport const DOMAINS_PSYCHOMOTOR = [\n  'Handwriting', 'Verbal Fluency', 'Sports/Games', 'Handling Tools', 'Drawing/Painting', 'Music/Dance'\n];\n\n// Mock Initial Data (Seeds)\nexport const SEED_TEACHERS: Teacher[] = [\n  { id: 't1', name: 'Mr. John Doe', address: 'Lagos', email: 'john@school.ng', phone: '08012345678', created_at: Date.now(), updated_at: Date.now() },\n  { id: 't2', name: 'Mrs. Jane Smith', address: 'Abuja', email: 'jane@school.ng', phone: '08087654321', created_at: Date.now(), updated_at: Date.now() },\n];\n\nexport const SEED_STAFF: Staff[] = [\n  { id: 'st1', name: 'Mrs. Grace Okoro', role: 'Bursar', tasks: 'Collect fees, manage accounts', email: 'bursar@school.ng', phone: '08099999999', address: 'Lagos', created_at: Date.now(), updated_at: Date.now() },\n  { id: 'st2', name: 'Mr. Ahmed Musa', role: 'Security', tasks: 'Gate security, patrol', email: '', phone: '08088888888', address: 'Lagos', created_at: Date.now(), updated_at: Date.now() },\n];\n\nexport const SEED_CLASSES: Class[] = PRESET_CLASSES.map((name, i) => ({\n  id: `c-${i}`,\n  name,\n  class_teacher_id: i === 0 ? 't1' : (i === 3 ? 't2' : null),\n  subjects: null,\n  created_at: Date.now(),\n  updated_at: Date.now(),\n}));\n\nexport const SEED_STUDENTS: Student[] = [\n  { id: 's1', student_no: 'ST001', names: 'Chinedu Eze', gender: 'Male', class_id: 'c-3', dob: '2015-05-12', parent_name: 'Mr. Eze', parent_phone: '08000000001', address: 'Ikeja', created_at: Date.now(), updated_at: Date.now() },\n  { id: 's2', student_no: 'ST002', names: 'Amina Bello', gender: 'Female', class_id: 'c-3', dob: '2015-08-23', parent_name: 'Mrs. Bello', parent_phone: '08000000002', address: 'Lekki', created_at: Date.now(), updated_at: Date.now() },\n  { id: 's3', student_no: 'ST003', names: 'Funke Akindele', gender: 'Female', class_id: 'c-0', dob: '2019-02-10', parent_name: 'Mr. Akindele', parent_phone: '08000000003', address: 'Yaba', created_at: Date.now(), updated_at: Date.now() },\n];\n\nexport const formatCurrency = (amount: number) => {\n  return new Intl.NumberFormat('en-NG', { style: 'currency', currency: 'NGN' }).format(amount);\n};\n\nexport const getStudentBalance = (student: Student, fees: FeeStructure[], payments: Payment[], session: string, term: string) => {\n  // Calculate total bill for this session/term\n  const classFees = fees.filter(f =>\n    f.session === session &&\n    f.term === term &&\n    (f.class_id === null || f.class_id === student.class_id)\n  );\n  const totalBill = classFees.reduce((acc, f) => acc + f.amount, 0);\n\n  // Calculate total paid\n  const studentPayments = payments.filter(p =>\n    p.student_id === student.id &&\n    p.session === session &&\n    p.term === term\n  );\n  const totalPaid = studentPayments.reduce((acc, p) => acc + p.amount, 0);\n\n  return { totalBill, totalPaid, balance: totalBill - totalPaid };\n};\n\nexport const getStudentPosition = (studentId: string, students: Student[], scores: Score[], session: string, term: string) => {\n  const student = students.find(s => s.id === studentId);\n  if (!student) return null;\n\n  const classStudents = students.filter(s => s.class_id === student.class_id);\n  const classScores = classStudents.map(s => {\n    const score = scores.find(sc => sc.student_id === s.id && sc.session === session && sc.term === term);\n    return {\n      student_id: s.id,\n      total: score?.rows.reduce((acc, r) => acc + r.total, 0) || 0\n    };\n  }).sort((a, b) => b.total - a.total);\n\n  const index = classScores.findIndex(s => s.student_id === studentId);\n  return index !== -1 ? index + 1 : null;\n};\n\n// Helper to ordinalize numbers (1st, 2nd, 3rd)\nexport const ordinalSuffix = (i: number) => {\n  const j = i % 10, k = i % 100;\n  if (j === 1 && k !== 11) return i + \"st\";\n  if (j === 2 && k !== 12) return i + \"nd\";\n  if (j === 3 && k !== 13) return i + \"rd\";\n  return i + \"th\";\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 479, "column": 0}, "map": {"version":3,"sources":["file:///D:/school_manager/lib/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { persist, createJSONStorage } from 'zustand/middleware';\r\nimport * as Types from './types';\r\nimport * as Utils from './utils';\r\n\r\ninterface SchoolState {\r\n    settings: Types.Settings;\r\n    students: Types.Student[];\r\n    teachers: Types.Teacher[];\r\n    staff: Types.Staff[];\r\n    classes: Types.Class[];\r\n    scores: Types.Score[];\r\n    fees: Types.FeeStructure[];\r\n    payments: Types.Payment[];\r\n    expenses: Types.Expense[];\r\n    attendance: Types.Attendance[];\r\n    // Phase 2-4: New State\r\n    subjectTeachers: Types.SubjectTeacher[];\r\n    announcements: Types.Announcement[];\r\n    messages: Types.Message[];\r\n    events: Types.SchoolEvent[];\r\n    isLoaded: boolean;\r\n    currentUser: any | null;\r\n    currentRole: Types.UserRole;\r\n    view: Types.ViewState;\r\n\r\n    // Actions\r\n    setSettings: (settings: Types.Settings) => void;\r\n    setView: (view: Types.ViewState) => void;\r\n\r\n    // Auth Actions\r\n    login: (role: Types.UserRole, user?: any) => void;\r\n    logout: () => void;\r\n    switchRole: (role: Types.UserRole) => void;\r\n\r\n    // Student Actions\r\n    addStudent: (student: Types.Student) => void;\r\n    updateStudent: (student: Types.Student) => void;\r\n    deleteStudent: (id: string) => void;\r\n\r\n    // Teacher Actions\r\n    addTeacher: (teacher: Types.Teacher) => void;\r\n    updateTeacher: (teacher: Types.Teacher) => void;\r\n    deleteTeacher: (id: string) => void;\r\n\r\n    // Staff Actions\r\n    addStaff: (staff: Types.Staff) => void;\r\n    updateStaff: (staff: Types.Staff) => void;\r\n    deleteStaff: (id: string) => void;\r\n\r\n    // Class Actions\r\n    setClasses: (classes: Types.Class[]) => void;\r\n    updateClass: (cls: Types.Class) => void;\r\n\r\n    // Academic Actions\r\n    setScores: (scores: Types.Score[]) => void;\r\n    setAttendance: (attendance: Types.Attendance[]) => void;\r\n\r\n    // Financial Actions\r\n    addPayment: (payment: Types.Payment) => void;\r\n    deletePayment: (id: string) => void;\r\n    addFee: (fee: Types.FeeStructure) => void;\r\n    deleteFee: (id: string) => void;\r\n    addExpense: (expense: Types.Expense) => void;\r\n    deleteExpense: (id: string) => void;\r\n\r\n    // Phase 2: Subject-Teacher Actions\r\n    addSubjectTeacher: (mapping: Types.SubjectTeacher) => void;\r\n    removeSubjectTeacher: (id: string) => void;\r\n\r\n    // Phase 3: Announcement Actions\r\n    addAnnouncement: (a: Types.Announcement) => void;\r\n    updateAnnouncement: (a: Types.Announcement) => void;\r\n    deleteAnnouncement: (id: string) => void;\r\n\r\n    // Phase 3: Message Actions\r\n    addMessage: (m: Types.Message) => void;\r\n    markMessageRead: (id: string) => void;\r\n    deleteMessage: (id: string) => void;\r\n\r\n    // Phase 3: Event Actions\r\n    addEvent: (e: Types.SchoolEvent) => void;\r\n    updateEvent: (e: Types.SchoolEvent) => void;\r\n    deleteEvent: (id: string) => void;\r\n\r\n    // Hydration\r\n    initStore: () => void;\r\n}\r\n\r\nexport const useSchoolStore = create<SchoolState>()(\r\n    persist(\r\n        (set, get) => ({\r\n            settings: Utils.INITIAL_SETTINGS,\r\n            students: [],\r\n            teachers: [],\r\n            staff: [],\r\n            classes: [],\r\n            scores: [],\r\n            fees: [],\r\n            payments: [],\r\n            expenses: [],\r\n            attendance: [],\r\n            subjectTeachers: [],\r\n            announcements: [],\r\n            messages: [],\r\n            events: [],\r\n            isLoaded: false,\r\n            currentUser: null,\r\n            currentRole: 'admin',\r\n            view: 'dashboard',\r\n\r\n            initStore: () => {\r\n                if (get().isLoaded) return;\r\n                set({\r\n                    settings: Utils.loadFromStorage(Utils.STORAGE_KEYS.SETTINGS, Utils.INITIAL_SETTINGS),\r\n                    students: Utils.loadFromStorage(Utils.STORAGE_KEYS.STUDENTS, Utils.SEED_STUDENTS),\r\n                    teachers: Utils.loadFromStorage(Utils.STORAGE_KEYS.TEACHERS, Utils.SEED_TEACHERS),\r\n                    staff: Utils.loadFromStorage(Utils.STORAGE_KEYS.STAFF, Utils.SEED_STAFF),\r\n                    classes: Utils.loadFromStorage(Utils.STORAGE_KEYS.CLASSES, Utils.SEED_CLASSES),\r\n                    scores: Utils.loadFromStorage(Utils.STORAGE_KEYS.SCORES, []),\r\n                    fees: Utils.loadFromStorage(Utils.STORAGE_KEYS.FEES, []),\r\n                    payments: Utils.loadFromStorage(Utils.STORAGE_KEYS.PAYMENTS, []),\r\n                    expenses: Utils.loadFromStorage(Utils.STORAGE_KEYS.EXPENSES, []),\r\n                    attendance: Utils.loadFromStorage(Utils.STORAGE_KEYS.ATTENDANCE, []),\r\n                    isLoaded: true,\r\n                });\r\n            },\r\n\r\n            setSettings: (settings) => set({ settings }),\r\n            setView: (view) => set({ view }),\r\n\r\n            login: (role, user = null) => set({ currentRole: role, currentUser: user, view: 'dashboard' }),\r\n            logout: () => set({ currentUser: null, currentRole: 'admin', view: 'dashboard' }), // For demo, default to admin\r\n            switchRole: (role) => set({ currentRole: role, view: 'dashboard' }),\r\n\r\n            addStudent: (student) => set((state) => ({ students: [...state.students, student] })),\r\n            updateStudent: (student) => set((state) => ({ students: state.students.map((s) => (s.id === student.id ? student : s)) })),\r\n            deleteStudent: (id) => set((state) => ({ students: state.students.filter((s) => s.id !== id) })),\r\n\r\n            addTeacher: (teacher) => set((state) => ({ teachers: [...state.teachers, teacher] })),\r\n            updateTeacher: (teacher) => set((state) => ({ teachers: state.teachers.map((t) => (t.id === teacher.id ? teacher : t)) })),\r\n            deleteTeacher: (id) => set((state) => ({ teachers: state.teachers.filter((t) => t.id !== id) })),\r\n\r\n            addStaff: (staffMember) => set((state) => ({ staff: [...state.staff, staffMember] })),\r\n            updateStaff: (staffMember) => set((state) => ({ staff: state.staff.map((s) => (s.id === staffMember.id ? staffMember : s)) })),\r\n            deleteStaff: (id) => set((state) => ({ staff: state.staff.filter((s) => s.id !== id) })),\r\n\r\n            setClasses: (classes) => set({ classes }),\r\n            updateClass: (cls) => set((state) => ({ classes: state.classes.map((c) => (c.id === cls.id ? cls : c)) })),\r\n\r\n            setScores: (scores) => set({ scores }),\r\n            setAttendance: (attendance) => set({ attendance }),\r\n\r\n            addPayment: (payment) => set((state) => ({ payments: [...state.payments, payment] })),\r\n            deletePayment: (id) => set((state) => ({ payments: state.payments.filter((p) => p.id !== id) })),\r\n\r\n            addFee: (fee) => set((state) => ({ fees: [...state.fees, fee] })),\r\n            deleteFee: (id) => set((state) => ({ fees: state.fees.filter((f) => f.id !== id) })),\r\n\r\n            addExpense: (expense) => set((state) => ({ expenses: [...state.expenses, expense] })),\r\n            deleteExpense: (id) => set((state) => ({ expenses: state.expenses.filter((e) => e.id !== id) })),\r\n\r\n            // Phase 2: Subject-Teacher Actions\r\n            addSubjectTeacher: (mapping) => set((state) => ({ subjectTeachers: [...state.subjectTeachers, mapping] })),\r\n            removeSubjectTeacher: (id) => set((state) => ({ subjectTeachers: state.subjectTeachers.filter((st) => st.id !== id) })),\r\n\r\n            // Phase 3: Announcement Actions\r\n            addAnnouncement: (a) => set((state) => ({ announcements: [...state.announcements, a] })),\r\n            updateAnnouncement: (a) => set((state) => ({ announcements: state.announcements.map((ann) => (ann.id === a.id ? a : ann)) })),\r\n            deleteAnnouncement: (id) => set((state) => ({ announcements: state.announcements.filter((a) => a.id !== id) })),\r\n\r\n            // Phase 3: Message Actions\r\n            addMessage: (m) => set((state) => ({ messages: [...state.messages, m] })),\r\n            markMessageRead: (id) => set((state) => ({ messages: state.messages.map((m) => (m.id === id ? { ...m, is_read: true } : m)) })),\r\n            deleteMessage: (id) => set((state) => ({ messages: state.messages.filter((m) => m.id !== id) })),\r\n\r\n            // Phase 3: Event Actions\r\n            addEvent: (e) => set((state) => ({ events: [...state.events, e] })),\r\n            updateEvent: (e) => set((state) => ({ events: state.events.map((ev) => (ev.id === e.id ? e : ev)) })),\r\n            deleteEvent: (id) => set((state) => ({ events: state.events.filter((e) => e.id !== id) })),\r\n        }),\r\n        {\r\n            name: 'ng-school-storage',\r\n            storage: createJSONStorage(() => localStorage),\r\n            // We explicitly handle legacy storage keys in initStore for now\r\n        }\r\n    )\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 679, "column": 0}, "map": {"version":3,"sources":["file:///D:/school_manager/components/features/LoginView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { useSchoolStore } from '@/lib/store';\r\nimport { UserRole } from '@/lib/types';\r\nimport {\r\n    ShieldCheck,\r\n    Users,\r\n    GraduationCap,\r\n    Heart,\r\n    ArrowRight\r\n} from 'lucide-react';\r\n\r\nexport const LoginView = () => {\r\n    const { login, settings } = useSchoolStore();\r\n    const [selectedRole, setSelectedRole] = useState<UserRole | null>(null);\r\n\r\n    const roles = [\r\n        {\r\n            id: 'super_admin' as UserRole,\r\n            name: 'Super Admin',\r\n            icon: ShieldCheck,\r\n            color: 'bg-red-600',\r\n            desc: 'System owner. Control roles and landing page CMS.'\r\n        },\r\n        {\r\n            id: 'admin' as UserRole,\r\n            name: 'Principal / Admin',\r\n            icon: ShieldCheck,\r\n            color: 'bg-blue-500',\r\n            desc: 'Academic and administrative oversight.'\r\n        },\r\n        {\r\n            id: 'teacher' as UserRole,\r\n            name: 'Teacher',\r\n            icon: Users,\r\n            color: 'bg-green-500',\r\n            desc: 'Manage grades, attendance, and class records.'\r\n        },\r\n        {\r\n            id: 'student' as UserRole,\r\n            name: 'Student / Parent',\r\n            icon: GraduationCap,\r\n            color: 'bg-purple-500',\r\n            desc: 'View results, check fees, and profile.'\r\n        },\r\n        {\r\n            id: 'staff' as UserRole,\r\n            name: 'Operations / Staff',\r\n            icon: Users,\r\n            color: 'bg-amber-500',\r\n            desc: 'Non-teaching staff dashboard & tasks.'\r\n        },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-6\">\r\n            <div className=\"w-full max-w-4xl space-y-8\">\r\n                <div className=\"text-center space-y-2\">\r\n                    {settings.logo_media ? (\r\n                        <img src={settings.logo_media} alt=\"Logo\" className=\"h-20 mx-auto mb-4 object-contain\" />\r\n                    ) : (\r\n                        <div className=\"h-20 w-20 bg-brand-600 rounded-2xl flex items-center justify-center text-white text-3xl font-bold mx-auto mb-4 shadow-xl\">NG</div>\r\n                    )}\r\n                    <h1 className=\"text-3xl font-black text-gray-900 uppercase tracking-tight\">{settings.school_name}</h1>\r\n                    <p className=\"text-gray-500 font-medium\">Welcome back! Please select your portal to continue.</p>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4\">\r\n                    {roles.map((role) => (\r\n                        <button\r\n                            key={role.id}\r\n                            onClick={() => setSelectedRole(role.id)}\r\n                            className={`relative group bg-white p-8 rounded-3xl border-2 transition-all duration-300 text-left hover:shadow-2xl hover:-translate-y-1 ${selectedRole === role.id\r\n                                ? 'border-brand-500 ring-4 ring-brand-50'\r\n                                : 'border-transparent shadow-sm'\r\n                                }`}\r\n                        >\r\n                            <div className={`${role.color} w-16 h-16 rounded-2xl flex items-center justify-center text-white mb-6 shadow-lg group-hover:scale-110 transition-transform`}>\r\n                                <role.icon size={32} />\r\n                            </div>\r\n                            <h3 className=\"text-xl font-bold text-gray-900 mb-2\">{role.name}</h3>\r\n                            <p className=\"text-sm text-gray-500 leading-relaxed mb-8\">{role.desc}</p>\r\n\r\n                            <div className={`flex items-center gap-2 text-sm font-bold transition-colors ${selectedRole === role.id ? 'text-brand-600' : 'text-gray-400 group-hover:text-brand-500'\r\n                                }`}>\r\n                                Click to Select <ArrowRight size={16} />\r\n                            </div>\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n\r\n                {selectedRole && (\r\n                    <div className=\"flex justify-center pt-4 animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n                        <button\r\n                            onClick={() => login(selectedRole, { role: selectedRole, name: 'Demo User' })}\r\n                            className=\"bg-brand-600 hover:bg-brand-700 text-white px-12 py-4 rounded-2xl font-black text-lg shadow-xl shadow-brand-200 flex items-center gap-3 transition-all hover:scale-105 active:scale-95\"\r\n                        >\r\n                            Enter Portal <ArrowRight />\r\n                        </button>\r\n                    </div>\r\n                )}\r\n\r\n                <div className=\"text-center pt-8\">\r\n                    <p className=\"text-xs text-gray-400 font-medium flex items-center justify-center gap-1\">\r\n                        Made with <Heart size={12} className=\"text-red-400 fill-current\" /> by NG School Management System\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AALA;;;;;AAaO,MAAM,YAAY;IACrB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,IAAA,8HAAc;IAC1C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAkB;IAElE,MAAM,QAAQ;QACV;YACI,IAAI;YACJ,MAAM;YACN,MAAM,mOAAW;YACjB,OAAO;YACP,MAAM;QACV;QACA;YACI,IAAI;YACJ,MAAM;YACN,MAAM,mOAAW;YACjB,OAAO;YACP,MAAM;QACV;QACA;YACI,IAAI;YACJ,MAAM;YACN,MAAM,6MAAK;YACX,OAAO;YACP,MAAM;QACV;QACA;YACI,IAAI;YACJ,MAAM;YACN,MAAM,yOAAa;YACnB,OAAO;YACP,MAAM;QACV;QACA;YACI,IAAI;YACJ,MAAM;YACN,MAAM,6MAAK;YACX,OAAO;YACP,MAAM;QACV;KACH;IAED,qBACI,8OAAC;QAAI,WAAU;kBACX,cAAA,8OAAC;YAAI,WAAU;;8BACX,8OAAC;oBAAI,WAAU;;wBACV,SAAS,UAAU,iBAChB,8OAAC;4BAAI,KAAK,SAAS,UAAU;4BAAE,KAAI;4BAAO,WAAU;;;;;qFAEpD,8OAAC;4BAAI,WAAU;sCAA2H;;;;;;sCAE9I,8OAAC;4BAAG,WAAU;sCAA8D,SAAS,WAAW;;;;;;sCAChG,8OAAC;4BAAE,WAAU;sCAA4B;;;;;;;;;;;;8BAG7C,8OAAC;oBAAI,WAAU;8BACV,MAAM,GAAG,CAAC,CAAC,qBACR,8OAAC;4BAEG,SAAS,IAAM,gBAAgB,KAAK,EAAE;4BACtC,WAAW,CAAC,6HAA6H,EAAE,iBAAiB,KAAK,EAAE,GAC7J,0CACA,gCACA;;8CAEN,8OAAC;oCAAI,WAAW,GAAG,KAAK,KAAK,CAAC,4HAA4H,CAAC;8CACvJ,cAAA,8OAAC,KAAK,IAAI;wCAAC,MAAM;;;;;;;;;;;8CAErB,8OAAC;oCAAG,WAAU;8CAAwC,KAAK,IAAI;;;;;;8CAC/D,8OAAC;oCAAE,WAAU;8CAA8C,KAAK,IAAI;;;;;;8CAEpE,8OAAC;oCAAI,WAAW,CAAC,4DAA4D,EAAE,iBAAiB,KAAK,EAAE,GAAG,mBAAmB,4CACvH;;wCAAE;sDACY,8OAAC,gOAAU;4CAAC,MAAM;;;;;;;;;;;;;2BAfjC,KAAK,EAAE;;;;;;;;;;gBAqBvB,8BACG,8OAAC;oBAAI,WAAU;8BACX,cAAA,8OAAC;wBACG,SAAS,IAAM,MAAM,cAAc;gCAAE,MAAM;gCAAc,MAAM;4BAAY;wBAC3E,WAAU;;4BACb;0CACgB,8OAAC,gOAAU;;;;;;;;;;;;;;;;8BAKpC,8OAAC;oBAAI,WAAU;8BACX,cAAA,8OAAC;wBAAE,WAAU;;4BAA2E;0CAC1E,8OAAC,6MAAK;gCAAC,MAAM;gCAAI,WAAU;;;;;;4BAA8B;;;;;;;;;;;;;;;;;;;;;;;AAM3F"}},
    {"offset": {"line": 914, "column": 0}, "map": {"version":3,"sources":["file:///D:/school_manager/app/%28dashboard%29/layout.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport {\r\n    LayoutDashboard, Users, BookOpen, GraduationCap,\r\n    CalendarCheck, CreditCard, Database, Settings as SettingsIcon,\r\n    LogOut, Menu, ClipboardList, BadgeCheck, UserCog,\r\n    Megaphone, Calendar, BarChart3\r\n} from 'lucide-react';\r\nimport Link from 'next/link';\r\nimport { usePathname } from 'next/navigation';\r\nimport { useSchoolStore } from '@/lib/store';\r\nimport * as Types from '@/lib/types';\r\nimport { LoginView } from '@/components/features/LoginView';\r\n\r\nexport default function DashboardLayout({ children }: { children: React.ReactNode }) {\r\n    const { settings, initStore, isLoaded } = useSchoolStore();\r\n    const [isSidebarOpen, setIsSidebarOpen] = useState(true);\r\n    const pathname = usePathname();\r\n\r\n    useEffect(() => {\r\n        initStore();\r\n    }, [initStore]);\r\n\r\n    const navigation = [\r\n        { id: 'dashboard', name: 'Dashboard', href: '/dashboard', icon: LayoutDashboard },\r\n        { id: 'students', name: 'Students', href: '/students', icon: GraduationCap },\r\n        { id: 'teachers', name: 'Teachers', href: '/teachers', icon: Users },\r\n        { id: 'staff', name: 'Non-Academic', icon: UserCog, href: '/staff' },\r\n        { id: 'classes', name: 'Classes', href: '/classes', icon: BookOpen },\r\n        { id: 'grading', name: 'Grading', href: '/grading', icon: ClipboardList },\r\n        { id: 'attendance', name: 'Attendance', href: '/attendance', icon: CalendarCheck },\r\n        { id: 'bursary', name: 'Bursary', href: '/bursary', icon: CreditCard },\r\n        { id: 'announcements', name: 'Announcements', href: '/announcements', icon: Megaphone },\r\n        { id: 'calendar', name: 'Calendar', href: '/calendar', icon: Calendar },\r\n        { id: 'analytics', name: 'Analytics', href: '/analytics', icon: BarChart3 },\r\n        { id: 'id_cards', name: 'ID Cards', href: '/id_cards', icon: BadgeCheck },\r\n        { id: 'broadsheet', name: 'Broadsheet', href: '/broadsheet', icon: LayoutDashboard },\r\n        { id: 'data', name: 'System Data', href: '/data', icon: Database },\r\n        { id: 'settings', name: 'Settings', href: '/settings', icon: SettingsIcon },\r\n    ];\r\n\r\n    const { currentRole, currentUser, logout, switchRole } = useSchoolStore();\r\n\r\n    // Get allowed navigation from role permissions (fallback to all for super_admin)\r\n    const rolePermissions = settings.role_permissions?.[currentRole];\r\n    const allowedNavIds = currentRole === 'super_admin'\r\n        ? navigation.map(n => n.id)\r\n        : (rolePermissions?.navigation || ['dashboard']);\r\n    const filteredNavigation = navigation.filter(item => allowedNavIds.includes(item.id));\r\n\r\n    if (!isLoaded) {\r\n        return <div className=\"h-screen w-full flex items-center justify-center bg-gray-50\"><div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-600\"></div></div>;\r\n    }\r\n\r\n    if (!currentUser) {\r\n        return <LoginView />;\r\n    }\r\n\r\n    return (\r\n        <div className=\"h-screen bg-gray-50 flex overflow-hidden\">\r\n            {/* Sidebar */}\r\n            <aside className={`${isSidebarOpen ? 'w-64' : 'w-20'} h-full bg-brand-900 transition-all duration-300 flex flex-col fixed inset-y-0 z-40 lg:relative no-print`}>\r\n                <div className=\"h-20 flex items-center px-6 border-b border-white/10 shrink-0\">\r\n                    <div className=\"h-10 w-10 bg-white rounded-lg flex items-center justify-center text-brand-600 font-bold shrink-0\">NG</div>\r\n                    {isSidebarOpen && <span className=\"ml-3 text-white font-bold text-xl truncate tracking-tight\">{settings.school_name.split(' ')[0]}</span>}\r\n                </div>\r\n\r\n                <nav className=\"flex-1 px-4 py-6 space-y-1 overflow-y-auto custom-scrollbar text-white\">\r\n                    {filteredNavigation.map((item) => (\r\n                        <Link\r\n                            key={item.id}\r\n                            href={item.href}\r\n                            className={`w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors group ${pathname === item.href\r\n                                ? 'bg-white/10 text-white'\r\n                                : 'text-brand-100 hover:bg-white/5 hover:text-white'\r\n                                }`}\r\n                        >\r\n                            <item.icon className=\"h-5 w-5 shrink-0\" />\r\n                            {isSidebarOpen && <span className=\"ml-3\">{item.name}</span>}\r\n                        </Link>\r\n                    ))}\r\n                </nav>\r\n\r\n                <div className=\"p-4 border-t border-white/10 shrink-0\">\r\n                    <button\r\n                        onClick={() => logout()}\r\n                        className=\"w-full flex items-center px-4 py-3 text-sm font-medium text-brand-100 hover:bg-white/5 hover:text-white rounded-lg transition-colors\"\r\n                    >\r\n                        <LogOut className=\"h-5 w-5 shrink-0\" />\r\n                        {isSidebarOpen && <span className=\"ml-3\">Log Out</span>}\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"flex-1 flex flex-col min-w-0 h-full overflow-hidden\">\r\n                <header className=\"h-20 bg-white border-b sticky top-0 z-30 flex items-center justify-between px-6 no-print shadow-sm shrink-0\">\r\n                    <button onClick={() => setIsSidebarOpen(!isSidebarOpen)} className=\"p-2 rounded-md transition-colors hover:bg-gray-100\">\r\n                        {isSidebarOpen ? <Menu className=\"h-6 w-6 text-gray-600\" /> : <Menu className=\"h-6 w-6 text-gray-600 rotate-90 transition-transform\" />}\r\n                    </button>\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <div className=\"text-right hidden sm:block\">\r\n                            <p className=\"text-sm font-bold text-gray-900 uppercase tracking-tight\">{currentRole}</p>\r\n                            <p className=\"text-xs text-brand-600 font-medium\">{settings.current_term}</p>\r\n                        </div>\r\n                        <div className=\"h-10 w-10 bg-brand-50 rounded-full border-2 border-brand-100 flex items-center justify-center font-bold text-brand-700 uppercase\">\r\n                            {currentRole.substring(0, 2)}\r\n                        </div>\r\n                    </div>\r\n                </header>\r\n\r\n                <div className=\"flex-1 overflow-y-auto p-6 md:p-8\">\r\n                    <div className=\"max-w-7xl mx-auto\">\r\n                        {children}\r\n                    </div>\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}