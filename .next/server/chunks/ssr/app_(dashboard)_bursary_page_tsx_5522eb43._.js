module.exports=[15553,a=>{"use strict";var b=a.i(87924),c=a.i(68515),d=a.i(72131),e=a.i(49679),f=a.i(15618),g=a.i(71931),h=a.i(81560),i=a.i(46842),j=a.i(3130),k=a.i(40695),l=a.i(87682),m=a.i(97895);let n=({students:a,classes:c,fees:d,payments:e,settings:n,selectedClass:o,setSelectedClass:p,selectedStudent:q,setSelectedStudent:r,onRecordPayment:s,onPrintReceipt:t,onDeletePayment:u})=>{let v=a.filter(a=>a.class_id===o),w=a.find(a=>a.id===q),x=q?e.filter(a=>a.student_id===q):[],y=w?d.filter(a=>a.session===n.current_session&&a.term===n.current_term&&(null===a.class_id||a.class_id===w.class_id)):[],{totalBill:z,totalPaid:A,balance:B}=w?m.getStudentBalance(w,d,e,n.current_session,n.current_term):{totalBill:0,totalPaid:0,balance:0};return(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsx)("div",{className:"md:col-span-1 space-y-4",children:(0,b.jsxs)(j.Card,{className:"h-full",children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(l.Select,{label:"Select Class",value:o,onChange:a=>p(a.target.value),children:c.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))})}),(0,b.jsx)("div",{className:"space-y-1 h-[600px] overflow-y-auto",children:v.map(a=>{let c=m.getStudentBalance(a,d,e,n.current_session,n.current_term).balance;return(0,b.jsxs)("div",{onClick:()=>r(a.id),className:`p-3 rounded-md cursor-pointer flex justify-between items-center text-sm ${q===a.id?"bg-brand-50 border-brand-200 border":"hover:bg-gray-50"}`,children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.names}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:a.student_no})]}),(0,b.jsx)("div",{className:`font-mono ${c>0?"text-red-600":"text-green-600"}`,children:c>0?`-${m.formatCurrency(c)}`:"Paid"})]},a.id)})})]})}),(0,b.jsx)("div",{className:"md:col-span-2",children:q&&w?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)(j.Card,{className:"bg-blue-50 border-blue-100 p-4",children:[(0,b.jsx)("div",{className:"text-sm text-blue-600",children:"Total Bill"}),(0,b.jsx)("div",{className:"text-xl font-bold text-blue-900",children:m.formatCurrency(z)})]}),(0,b.jsxs)(j.Card,{className:"bg-green-50 border-green-100 p-4",children:[(0,b.jsx)("div",{className:"text-sm text-green-600",children:"Total Paid"}),(0,b.jsx)("div",{className:"text-xl font-bold text-green-900",children:m.formatCurrency(A)})]}),(0,b.jsxs)(j.Card,{className:"bg-red-50 border-red-100 p-4",children:[(0,b.jsx)("div",{className:"text-sm text-red-600",children:"Outstanding"}),(0,b.jsx)("div",{className:"text-xl font-bold text-red-900",children:m.formatCurrency(B)})]})]}),(0,b.jsx)(j.Card,{title:"Bill Breakdown",children:(0,b.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,b.jsx)("thead",{className:"bg-gray-50 text-gray-700",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-2",children:"Fee Head"}),(0,b.jsx)("th",{className:"px-4 py-2 text-right",children:"Amount"})]})}),(0,b.jsxs)("tbody",{className:"divide-y divide-gray-100",children:[y.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-4 py-2",children:a.name}),(0,b.jsx)("td",{className:"px-4 py-2 text-right font-mono",children:m.formatCurrency(a.amount)})]},a.id)),(0,b.jsxs)("tr",{className:"bg-gray-50 font-bold",children:[(0,b.jsx)("td",{className:"px-4 py-2",children:"Total Billed"}),(0,b.jsx)("td",{className:"px-4 py-2 text-right",children:m.formatCurrency(z)})]})]})]})}),(0,b.jsx)(j.Card,{title:"Payment History",action:(0,b.jsxs)(k.Button,{size:"sm",onClick:s,children:[(0,b.jsx)(f.Plus,{className:"h-4 w-4 mr-2"})," Record Payment"]}),children:(0,b.jsxs)("div",{className:"space-y-3 mt-2",children:[0===x.length&&(0,b.jsx)("div",{className:"text-center py-4 text-gray-500",children:"No payments recorded."}),x.map(a=>(0,b.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded border border-gray-100",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-gray-900",children:m.formatCurrency(a.amount)}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:[a.date," â€¢ ",a.method]}),a.remark&&(0,b.jsxs)("div",{className:"text-xs text-gray-500 italic",children:['"',a.remark,'"']})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>t(a),title:"Print Receipt",className:"p-1 text-gray-400 hover:text-blue-600",children:(0,b.jsx)(g.Printer,{className:"h-4 w-4"})}),(0,b.jsx)("button",{onClick:()=>u(a.id),title:"Delete",className:"p-1 text-gray-400 hover:text-red-600",children:(0,b.jsx)(h.Trash2,{className:"h-4 w-4"})})]})]},a.id))]})})]}):(0,b.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 border-2 border-dashed border-gray-200 rounded-lg p-12",children:[(0,b.jsx)(i.User,{className:"h-12 w-12 mb-4 opacity-50"}),(0,b.jsx)("p",{children:"Select a student to view fees and payments"})]})})]})},o=({expenses:a,onAddExpense:c})=>(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(k.Button,{onClick:c,children:[(0,b.jsx)(f.Plus,{className:"h-4 w-4 mr-2"})," Record Expense"]})}),(0,b.jsx)(j.Card,{children:(0,b.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,b.jsx)("thead",{className:"bg-gray-50 text-gray-700",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-3",children:"Date"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Title"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Category"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right",children:"Amount"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-100",children:a.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-4 py-3",children:a.date}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.title}),(0,b.jsx)("td",{className:"px-4 py-3 capitalize",children:(0,b.jsx)("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs",children:a.category})}),(0,b.jsxs)("td",{className:"px-4 py-3 text-right font-mono text-red-600",children:["-",m.formatCurrency(a.amount)]})]},a.id))})]})})]}),p=({fees:a,classes:c,settings:d,onAddFeeHead:e,onDeleteFee:g})=>(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(k.Button,{onClick:e,children:[(0,b.jsx)(f.Plus,{className:"h-4 w-4 mr-2"})," Add Fee Head"]})}),(0,b.jsx)(j.Card,{title:"Current Session Fee Structure",children:(0,b.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,b.jsx)("thead",{className:"bg-gray-50 text-gray-700",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-3",children:"Fee Name"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Class Scope"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right",children:"Amount"}),(0,b.jsx)("th",{className:"px-4 py-3"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-100",children:a.filter(a=>a.session===d.current_session&&a.term===d.current_term).map(a=>{let d=a.class_id?c.find(b=>b.id===a.class_id)?.name:"All Classes";return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-4 py-3 font-medium",children:a.name}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 rounded text-xs",children:d})}),(0,b.jsx)("td",{className:"px-4 py-3 text-right font-mono",children:m.formatCurrency(a.amount)}),(0,b.jsx)("td",{className:"px-4 py-3 text-right",children:(0,b.jsx)("button",{onClick:()=>g(a.id),className:"text-gray-400 hover:text-red-600",children:(0,b.jsx)(h.Trash2,{className:"h-4 w-4"})})})]},a.id)})})]})})]});var q=a.i(32324),r=a.i(5522);let s=({payment:a,student:c,cls:d,settings:e,balance:f})=>(0,b.jsxs)("div",{className:"bg-white p-8 max-w-2xl mx-auto border border-gray-200 text-sm",id:"receipt-print",children:[(0,b.jsxs)("div",{className:"text-center mb-8 border-b pb-4",children:[e.logo_media&&(0,b.jsx)("img",{src:e.logo_media,alt:"Logo",className:"h-16 mx-auto mb-2"}),(0,b.jsx)("h1",{className:"text-2xl font-bold uppercase",children:e.school_name}),(0,b.jsx)("p",{children:e.school_address}),(0,b.jsxs)("p",{children:[e.school_email," | ",e.school_phone]})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold",children:"PAYMENT RECEIPT"}),(0,b.jsxs)("p",{children:["Receipt No: #",a.id.substring(0,8).toUpperCase()]}),(0,b.jsxs)("p",{children:["Date: ",a.date]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{children:["Session: ",a.session]}),(0,b.jsxs)("p",{children:["Term: ",a.term]})]})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Received From:"})," ",c.names," (",c.student_no,")"]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Class:"})," ",d?.name||"N/A"]})]}),(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-gray-100",children:[(0,b.jsx)("th",{className:"border border-gray-300 p-2 text-left",children:"Description"}),(0,b.jsx)("th",{className:"border border-gray-300 p-2 text-right",children:"Amount"})]})}),(0,b.jsx)("tbody",{children:(0,b.jsxs)("tr",{children:[(0,b.jsxs)("td",{className:"border border-gray-300 p-2",children:["School Fees Payment ",a.method&&` via ${a.method}`," ",a.remark&&` (${a.remark})`]}),(0,b.jsx)("td",{className:"border border-gray-300 p-2 text-right",children:m.formatCurrency(a.amount)})]})})]})}),(0,b.jsx)("div",{className:"flex justify-end mb-12",children:(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-lg font-bold",children:["Total Paid: ",m.formatCurrency(a.amount)]}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:["Balance Remaining: ",m.formatCurrency(f)]})]})}),(0,b.jsxs)("div",{className:"flex justify-between mt-12 pt-4 border-t",children:[(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("p",{className:"border-t border-black px-8 mt-8 pt-2",children:"Bursar's Signature"})}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("p",{className:"italic text-xs",children:"Thank you for your business."})})]})]}),t=({settings:a,classes:c,students:e,fees:f,payments:h,showPayModal:i,setShowPayModal:j,showExpenseModal:n,setShowExpenseModal:o,showFeeModal:p,setShowFeeModal:t,receiptPayment:u,setReceiptPayment:v,selectedStudent:w,onAddPayment:x,onAddExpense:y,onAddFee:z,addToast:A})=>{let[B,C]=(0,d.useState)(""),[D,E]=(0,d.useState)("cash"),[F,G]=(0,d.useState)(""),[H,I]=(0,d.useState)(""),[J,K]=(0,d.useState)(""),[L,M]=(0,d.useState)("supplies"),[N,O]=(0,d.useState)(m.getTodayString()),[P,Q]=(0,d.useState)(""),[R,S]=(0,d.useState)(""),[T,U]=(0,d.useState)(""),V=e.find(a=>a.id===w),{balance:W}=V?m.getStudentBalance(V,f,h,a.current_session,a.current_term):{balance:0};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.Modal,{isOpen:i,onClose:()=>j(!1),title:"Record Payment",children:(0,b.jsxs)("form",{onSubmit:b=>{b.preventDefault(),w&&(x({id:m.generateId(),student_id:w,amount:Number(B),method:D,remark:F,date:m.getTodayString(),session:a.current_session,term:a.current_term,created_at:Date.now(),updated_at:Date.now()}),A("Payment recorded successfully","success"),j(!1),C(""),G(""))},className:"space-y-4",children:[(0,b.jsx)(r.Input,{label:"Amount (NGN)",type:"number",required:!0,value:B,onChange:a=>C(a.target.value)}),(0,b.jsxs)(l.Select,{label:"Payment Method",value:D,onChange:a=>E(a.target.value),children:[(0,b.jsx)("option",{value:"cash",children:"Cash"}),(0,b.jsx)("option",{value:"transfer",children:"Bank Transfer"}),(0,b.jsx)("option",{value:"pos",children:"POS"})]}),(0,b.jsx)(r.Input,{label:"Remark/Note",value:F,onChange:a=>G(a.target.value)}),(0,b.jsx)(k.Button,{type:"submit",className:"w-full",children:"Save Payment"})]})}),(0,b.jsx)(q.Modal,{isOpen:!!u,onClose:()=>v(null),title:"Print Receipt",children:u&&V&&(0,b.jsxs)("div",{className:"overflow-y-auto max-h-[80vh]",children:[(0,b.jsx)(s,{payment:u,student:V,cls:c.find(a=>a.id===V.class_id),settings:a,balance:W}),(0,b.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,b.jsx)(k.Button,{variant:"secondary",onClick:()=>v(null),children:"Close"}),(0,b.jsxs)(k.Button,{onClick:()=>window.print(),children:[(0,b.jsx)(g.Printer,{className:"h-4 w-4 mr-2"})," Print"]})]})]})}),(0,b.jsx)(q.Modal,{isOpen:n,onClose:()=>o(!1),title:"Record Expense",children:(0,b.jsxs)("form",{onSubmit:b=>{b.preventDefault(),y({id:m.generateId(),title:H,amount:Number(J),category:L,date:N,session:a.current_session,term:a.current_term,created_at:Date.now(),updated_at:Date.now()}),A("Expense recorded","success"),o(!1),I(""),K("")},className:"space-y-4",children:[(0,b.jsx)(r.Input,{label:"Title",required:!0,value:H,onChange:a=>I(a.target.value)}),(0,b.jsx)(r.Input,{label:"Amount",type:"number",required:!0,value:J,onChange:a=>K(a.target.value)}),(0,b.jsxs)(l.Select,{label:"Category",value:L,onChange:a=>M(a.target.value),children:[(0,b.jsx)("option",{value:"supplies",children:"Supplies"}),(0,b.jsx)("option",{value:"maintenance",children:"Maintenance"}),(0,b.jsx)("option",{value:"salary",children:"Salary"}),(0,b.jsx)("option",{value:"utilities",children:"Utilities"}),(0,b.jsx)("option",{value:"other",children:"Other"})]}),(0,b.jsx)(r.Input,{label:"Date",type:"date",value:N,onChange:a=>O(a.target.value)}),(0,b.jsx)(k.Button,{type:"submit",className:"w-full",children:"Save Expense"})]})}),(0,b.jsx)(q.Modal,{isOpen:p,onClose:()=>t(!1),title:"Add Fee Structure",children:(0,b.jsxs)("form",{onSubmit:b=>{b.preventDefault(),z({id:m.generateId(),name:P,amount:Number(R),class_id:T||null,session:a.current_session,term:a.current_term,created_at:Date.now(),updated_at:Date.now()}),A("Fee structure added","success"),t(!1),Q(""),S(""),U("")},className:"space-y-4",children:[(0,b.jsx)(r.Input,{label:"Fee Name",required:!0,value:P,onChange:a=>Q(a.target.value),placeholder:"e.g. Tuition Fee"}),(0,b.jsx)(r.Input,{label:"Amount",type:"number",required:!0,value:R,onChange:a=>S(a.target.value)}),(0,b.jsxs)(l.Select,{label:"Applicable Class",value:T,onChange:a=>U(a.target.value),children:[(0,b.jsx)("option",{value:"",children:"All Classes"}),c.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,b.jsx)(k.Button,{type:"submit",className:"w-full",children:"Create Fee"})]})})]})},u=({students:a,classes:c,fees:f,payments:g,expenses:h,settings:i,onAddPayment:j,onAddFee:k,onAddExpense:l,onDeletePayment:m,onDeleteFee:q})=>{let[r,s]=(0,d.useState)("fees"),[u,v]=(0,d.useState)(c[0]?.id||""),[w,x]=(0,d.useState)(null),[y,z]=(0,d.useState)(!1),[A,B]=(0,d.useState)(!1),[C,D]=(0,d.useState)(!1),[E,F]=(0,d.useState)(null),{addToast:G}=(0,e.useToast)();return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Bursary & Finance"}),(0,b.jsx)("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:["fees","expenses","structure"].map(a=>(0,b.jsx)("button",{onClick:()=>s(a),className:`px-4 py-2 text-sm font-medium rounded-md capitalize ${r===a?"bg-white shadow-sm text-brand-700":"text-gray-600 hover:text-gray-900"}`,children:a},a))})]}),"fees"===r&&(0,b.jsx)(n,{students:a,classes:c,fees:f,payments:g,settings:i,selectedClass:u,setSelectedClass:v,selectedStudent:w,setSelectedStudent:x,onRecordPayment:()=>z(!0),onPrintReceipt:a=>F(a),onDeletePayment:m}),"expenses"===r&&(0,b.jsx)(o,{expenses:h,onAddExpense:()=>B(!0)}),"structure"===r&&(0,b.jsx)(p,{fees:f,classes:c,settings:i,onAddFeeHead:()=>D(!0),onDeleteFee:q}),(0,b.jsx)(t,{settings:i,classes:c,students:a,fees:f,payments:g,showPayModal:y,setShowPayModal:z,showExpenseModal:A,setShowExpenseModal:B,showFeeModal:C,setShowFeeModal:D,receiptPayment:E,setReceiptPayment:F,selectedStudent:w,onAddPayment:j,onAddExpense:l,onAddFee:k,addToast:G})]})};function v(){let{students:a,classes:d,fees:e,payments:f,expenses:g,settings:h,addPayment:i,addFee:j,addExpense:k,deletePayment:l,deleteFee:m,deleteExpense:n}=(0,c.useSchoolStore)();return(0,b.jsx)(u,{students:a,classes:d,fees:e,payments:f,expenses:g,settings:h,onAddPayment:i,onAddFee:j,onAddExpense:k,onDeletePayment:l,onDeleteFee:m})}a.s(["default",()=>v],15553)}];

//# sourceMappingURL=app_%28dashboard%29_bursary_page_tsx_5522eb43._.js.map